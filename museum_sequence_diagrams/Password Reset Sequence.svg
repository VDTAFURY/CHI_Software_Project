<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2936px" preserveAspectRatio="none" style="width:1670px;height:2936px;background:#FFFFFF;" version="1.1" viewBox="0 0 1670 2936" width="1670px" zoomAndPan="magnify"><title>**Password Reset Process**</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="191.6387" x="735.5701" y="27.9951">Password Reset Process</text><g><title>Auth</title><rect fill="#FFFFFF" height="721.3906" style="stroke:#181818;stroke-width:1;" width="10" x="294.4629" y="192.8594"/></g><g><title>Auth</title><rect fill="#FFFFFF" height="495" style="stroke:#181818;stroke-width:1;" width="10" x="294.4629" y="986.5156"/></g><g><title>Auth</title><rect fill="#FFFFFF" height="1269.8516" style="stroke:#181818;stroke-width:1;" width="10" x="294.4629" y="1576.0469"/></g><g><title>User</title><rect fill="#FFFFFF" height="126.6641" style="stroke:#181818;stroke-width:1;" width="10" x="541.2744" y="221.9922"/></g><g><title>User</title><rect fill="#FFFFFF" height="117.6641" style="stroke:#181818;stroke-width:1;" width="10" x="541.2744" y="2016.7813"/></g><g><title>Token</title><rect fill="#FFFFFF" height="190.0625" style="stroke:#181818;stroke-width:1;" width="10" x="621.8384" y="377.7891"/></g><g><title>Token</title><rect fill="#FFFFFF" height="414.7344" style="stroke:#181818;stroke-width:1;" width="10" x="621.8384" y="1015.6484"/></g><g><title>Token</title><rect fill="#FFFFFF" height="104.5313" style="stroke:#181818;stroke-width:1;" width="10" x="621.8384" y="2163.5781"/></g><g><title>Database</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="889.978" y="266.2578"/></g><g><title>Database</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="889.978" y="509.5859"/></g><g><title>Database</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="889.978" y="1090.1797"/></g><g><title>Database</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="889.978" y="2076.1797"/></g><g><title>Database</title><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1;" width="10" x="889.978" y="2238.1094"/></g><g><title>Database</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="889.978" y="2356.6406"/></g><g><title>Database</title><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1;" width="10" x="889.978" y="2489.4375"/></g><g><title>Database</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="889.978" y="2607.9688"/></g><g><title>Email</title><rect fill="#FFFFFF" height="170.6641" style="stroke:#181818;stroke-width:1;" width="10" x="1089.2539" y="612.1172"/></g><g><title>Email</title><rect fill="#FFFFFF" height="186.7969" style="stroke:#181818;stroke-width:1;" width="10" x="1089.2539" y="2563.7031"/></g><g><title>Security</title><rect fill="#FFFFFF" height="71.2656" style="stroke:#181818;stroke-width:1;" width="10" x="1312.541" y="1901.25"/></g><g><title>Session</title><rect fill="#FFFFFF" height="73.3984" style="stroke:#181818;stroke-width:1;" width="10" x="1518.5879" y="2312.375"/></g><g><title>Audit</title><rect fill="#FFFFFF" height="89.3984" style="stroke:#181818;stroke-width:1;" width="10" x="1597.5249" y="2430.0391"/></g><rect fill="none" height="545.4609" style="stroke:#000000;stroke-width:1.5;" width="1022.8252" x="247.8765" y="310.3906"/><rect fill="none" height="340.2031" style="stroke:#000000;stroke-width:1.5;" width="884.978" x="10" y="1134.3125"/><rect fill="none" height="163.6016" style="stroke:#000000;stroke-width:1.5;" width="659.3853" x="20" y="1303.9141"/><rect fill="none" height="1190.5859" style="stroke:#000000;stroke-width:1.5;" width="1643.7788" x="10" y="1648.3125"/><rect fill="none" height="1027.9844" style="stroke:#000000;stroke-width:1.5;" width="1623.7788" x="20" y="1803.9141"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="2737.3047" width="8" x="44.9551" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="48" x2="48" y1="118.5938" y2="2855.8984"/></g><g><title>Auth</title><rect fill="#000000" fill-opacity="0.00000" height="2737.3047" width="8" x="295.4629" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="298.8765" x2="298.8765" y1="118.5938" y2="2855.8984"/></g><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="2737.3047" width="8" x="542.2744" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="546.2573" x2="546.2573" y1="118.5938" y2="2855.8984"/></g><g><title>Token</title><rect fill="#000000" fill-opacity="0.00000" height="2737.3047" width="8" x="622.8384" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="626.2915" x2="626.2915" y1="118.5938" y2="2855.8984"/></g><g><title>Database</title><rect fill="#000000" fill-opacity="0.00000" height="2737.3047" width="8" x="890.978" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="894.5776" x2="894.5776" y1="118.5938" y2="2855.8984"/></g><g><title>Email</title><rect fill="#000000" fill-opacity="0.00000" height="2737.3047" width="8" x="1090.2539" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1093.3833" x2="1093.3833" y1="118.5938" y2="2855.8984"/></g><g><title>Security</title><rect fill="#000000" fill-opacity="0.00000" height="2737.3047" width="8" x="1313.541" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1316.7959" x2="1316.7959" y1="118.5938" y2="2855.8984"/></g><g><title>Session</title><rect fill="#000000" fill-opacity="0.00000" height="2737.3047" width="8" x="1519.5879" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1522.9048" x2="1522.9048" y1="118.5938" y2="2855.8984"/></g><g><title>Audit</title><rect fill="#000000" fill-opacity="0.00000" height="2737.3047" width="8" x="1598.5249" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1602.271" x2="1602.271" y1="118.5938" y2="2855.8984"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="30" y="115.292">User</text><ellipse cx="48.9551" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M48.9551,58.7969 L48.9551,85.7969 M35.9551,66.7969 L61.9551,66.7969 M48.9551,85.7969 L35.9551,100.7969 M48.9551,85.7969 L61.9551,100.7969" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="30" y="2867.8936">User</text><ellipse cx="48.9551" cy="2879.6953" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M48.9551,2887.6953 L48.9551,2914.6953 M35.9551,2895.6953 L61.9551,2895.6953 M48.9551,2914.6953 L35.9551,2929.6953 M48.9551,2914.6953 L61.9551,2929.6953" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="AuthCtrl"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="83.1729" x="257.8765" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.8125" x="283.0566" y="90.9951">Auth</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69.1729" x="264.8765" y="107.292">Controller</text></g><g class="participant participant-tail" data-participant="AuthCtrl"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="83.1729" x="257.8765" y="2854.8984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.8125" x="283.0566" y="2874.8936">Auth</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69.1729" x="264.8765" y="2891.1904">Controller</text></g><g class="participant participant-head" data-participant="UserModel"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="56.0342" x="518.2573" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="530.3193" y="90.9951">User</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42.0342" x="525.2573" y="107.292">Model</text></g><g class="participant participant-tail" data-participant="UserModel"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="56.0342" x="518.2573" y="2854.8984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="530.3193" y="2874.8936">User</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42.0342" x="525.2573" y="2891.1904">Model</text></g><g class="participant participant-head" data-participant="Token"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85.0938" x="584.2915" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42.7109" x="605.4829" y="90.9951">Token</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71.0938" x="591.2915" y="107.292">Generator</text></g><g class="participant participant-tail" data-participant="Token"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85.0938" x="584.2915" y="2854.8984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42.7109" x="605.4829" y="2874.8936">Token</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71.0938" x="591.2915" y="2891.1904">Generator</text></g><g class="participant participant-head" data-participant="DB"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.8008" x="854.5776" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.8008" x="861.5776" y="107.292">Database</text></g><g class="participant participant-tail" data-participant="DB"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.8008" x="854.5776" y="2854.8984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.8008" x="861.5776" y="2874.8936">Database</text></g><g class="participant participant-head" data-participant="Email"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.7412" x="1061.3833" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.8418" x="1074.833" y="90.9951">Email</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.7412" x="1068.3833" y="107.292">Service</text></g><g class="participant participant-tail" data-participant="Email"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.7412" x="1061.3833" y="2854.8984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.8418" x="1074.833" y="2874.8936">Email</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.7412" x="1068.3833" y="2891.1904">Service</text></g><g class="participant participant-head" data-participant="Sec"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.4902" x="1281.7959" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.4902" x="1288.7959" y="107.292">Security</text></g><g class="participant participant-tail" data-participant="Sec"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.4902" x="1281.7959" y="2854.8984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.4902" x="1288.7959" y="2874.8936">Security</text></g><g class="participant participant-head" data-participant="Session"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="75.3662" x="1485.9048" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53.416" x="1496.8799" y="90.9951">Session</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61.3662" x="1492.9048" y="107.292">Manager</text></g><g class="participant participant-tail" data-participant="Session"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="75.3662" x="1485.9048" y="2854.8984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53.416" x="1496.8799" y="2874.8936">Session</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61.3662" x="1492.9048" y="2891.1904">Manager</text></g><g class="participant participant-head" data-participant="Logger"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="62.5078" x="1571.271" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.7158" x="1584.167" y="90.9951">Audit</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48.5078" x="1578.271" y="107.292">Logger</text></g><g class="participant participant-tail" data-participant="Logger"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="62.5078" x="1571.271" y="2854.8984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.7158" x="1584.167" y="2874.8936">Audit</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48.5078" x="1578.271" y="2891.1904">Logger</text></g><g><title>Auth</title><rect fill="#FFFFFF" height="721.3906" style="stroke:#181818;stroke-width:1;" width="10" x="294.4629" y="192.8594"/></g><g><title>Auth</title><rect fill="#FFFFFF" height="495" style="stroke:#181818;stroke-width:1;" width="10" x="294.4629" y="986.5156"/></g><g><title>Auth</title><rect fill="#FFFFFF" height="1269.8516" style="stroke:#181818;stroke-width:1;" width="10" x="294.4629" y="1576.0469"/></g><g><title>User</title><rect fill="#FFFFFF" height="126.6641" style="stroke:#181818;stroke-width:1;" width="10" x="541.2744" y="221.9922"/></g><g><title>User</title><rect fill="#FFFFFF" height="117.6641" style="stroke:#181818;stroke-width:1;" width="10" x="541.2744" y="2016.7813"/></g><g><title>Token</title><rect fill="#FFFFFF" height="190.0625" style="stroke:#181818;stroke-width:1;" width="10" x="621.8384" y="377.7891"/></g><g><title>Token</title><rect fill="#FFFFFF" height="414.7344" style="stroke:#181818;stroke-width:1;" width="10" x="621.8384" y="1015.6484"/></g><g><title>Token</title><rect fill="#FFFFFF" height="104.5313" style="stroke:#181818;stroke-width:1;" width="10" x="621.8384" y="2163.5781"/></g><g><title>Database</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="889.978" y="266.2578"/></g><g><title>Database</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="889.978" y="509.5859"/></g><g><title>Database</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="889.978" y="1090.1797"/></g><g><title>Database</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="889.978" y="2076.1797"/></g><g><title>Database</title><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1;" width="10" x="889.978" y="2238.1094"/></g><g><title>Database</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="889.978" y="2356.6406"/></g><g><title>Database</title><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1;" width="10" x="889.978" y="2489.4375"/></g><g><title>Database</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="889.978" y="2607.9688"/></g><g><title>Email</title><rect fill="#FFFFFF" height="170.6641" style="stroke:#181818;stroke-width:1;" width="10" x="1089.2539" y="612.1172"/></g><g><title>Email</title><rect fill="#FFFFFF" height="186.7969" style="stroke:#181818;stroke-width:1;" width="10" x="1089.2539" y="2563.7031"/></g><g><title>Security</title><rect fill="#FFFFFF" height="71.2656" style="stroke:#181818;stroke-width:1;" width="10" x="1312.541" y="1901.25"/></g><g><title>Session</title><rect fill="#FFFFFF" height="73.3984" style="stroke:#181818;stroke-width:1;" width="10" x="1518.5879" y="2312.375"/></g><g><title>Audit</title><rect fill="#FFFFFF" height="89.3984" style="stroke:#181818;stroke-width:1;" width="10" x="1597.5249" y="2430.0391"/></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1663.7788" x="0" y="149.1602"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1663.7788" y1="149.1602" y2="149.1602"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1663.7788" y1="152.1602" y2="152.1602"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="199.7642" x="732.0073" y="138.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="181.2383" x="738.0073" y="154.6606">Request Password Reset</text><g class="message" data-participant-1="User" data-participant-2="AuthCtrl"><polygon fill="#181818" points="282.4629,188.8594,292.4629,192.8594,282.4629,196.8594,286.4629,192.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="48.9551" x2="288.4629" y1="192.8594" y2="192.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194.1304" x="74.6438" y="187.7935">requestPasswordReset(email)</text></g><g class="message" data-participant-1="AuthCtrl" data-participant-2="UserModel"><polygon fill="#181818" points="529.2744,217.9922,539.2744,221.9922,529.2744,225.9922,533.2744,221.9922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="304.4629" x2="535.2744" y1="221.9922" y2="221.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152.9849" x="346.3762" y="216.9263">findUserByEmail(email)</text></g><g class="message" data-participant-1="UserModel" data-participant-2="DB"><polygon fill="#181818" points="877.978,262.2578,887.978,266.2578,877.978,270.2578,881.978,266.2578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="551.2744" x2="883.978" y1="266.2578" y2="266.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.9243" x="650.1641" y="246.0591">SELECT * FROM users</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.1309" x="663.5608" y="261.1919">WHERE email = ?</text></g><g class="message" data-participant-1="DB" data-participant-2="UserModel"><polygon fill="#181818" points="562.2744,291.3906,552.2744,295.3906,562.2744,299.3906,558.2744,295.3906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="556.2744" x2="893.978" y1="295.3906" y2="295.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.0835" x="686.0845" y="290.3247">userRecord</text></g><path d="M247.8765,310.3906 L312.3193,310.3906 L312.3193,317.5234 L302.3193,327.5234 L247.8765,327.5234 L247.8765,310.3906" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="545.4609" style="stroke:#000000;stroke-width:1.5;" width="1022.8252" x="247.8765" y="310.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="262.8765" y="323.4575">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="78.9819" x="327.3193" y="322.6011">[User Exists]</text><g class="message" data-participant-1="UserModel" data-participant-2="AuthCtrl"><polygon fill="#181818" points="315.4629,344.6563,305.4629,348.6563,315.4629,352.6563,311.4629,348.6563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="309.4629" x2="545.2744" y1="348.6563" y2="348.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.4409" x="405.1482" y="343.5903">userId</text></g><g class="message" data-participant-1="AuthCtrl" data-participant-2="Token"><polygon fill="#181818" points="609.8384,373.7891,619.8384,377.7891,609.8384,381.7891,613.8384,377.7891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="304.4629" x2="615.8384" y1="377.7891" y2="377.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.0371" x="370.1321" y="372.7231">generateResetToken(userId)</text></g><g class="message" data-participant-1="Token" data-participant-2="Token"><line style="stroke:#181818;stroke-width:1;" x1="631.8384" x2="673.8384" y1="406.9219" y2="406.9219"/><line style="stroke:#181818;stroke-width:1;" x1="673.8384" x2="673.8384" y1="406.9219" y2="419.9219"/><line style="stroke:#181818;stroke-width:1;" x1="632.8384" x2="673.8384" y1="419.9219" y2="419.9219"/><polygon fill="#181818" points="642.8384,415.9219,632.8384,419.9219,642.8384,423.9219,638.8384,419.9219" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170.2188" x="638.8384" y="401.856">generateSecureToken(32)</text></g><g class="message" data-participant-1="Token" data-participant-2="DB"><polygon fill="#181818" points="877.978,505.5859,887.978,509.5859,877.978,513.5859,881.978,509.5859" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="631.8384" x2="883.978" y1="509.5859" y2="509.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.8623" x="719.4771" y="443.9888">INSERT INTO</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.7471" x="685.0347" y="459.1216">password_reset_tokens</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.0039" x="710.4063" y="474.2544">(user_id, token,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.4624" x="687.177" y="489.3872">expiration_timestamp)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.6855" x="656.5654" y="504.52">VALUES (?, ?, NOW() + 1 HOUR)</text></g><g class="message" data-participant-1="DB" data-participant-2="Token"><polygon fill="#181818" points="642.8384,534.7188,632.8384,538.7188,642.8384,542.7188,638.8384,538.7188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="636.8384" x2="893.978" y1="538.7188" y2="538.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.8511" x="737.9827" y="533.6528">success</text></g><g class="message" data-participant-1="Token" data-participant-2="AuthCtrl"><polygon fill="#181818" points="315.4629,563.8516,305.4629,567.8516,315.4629,571.8516,311.4629,567.8516" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="309.4629" x2="625.8384" y1="567.8516" y2="567.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72.8711" x="429.2151" y="562.7856">resetToken</text></g><g class="message" data-participant-1="AuthCtrl" data-participant-2="Email"><polygon fill="#181818" points="1077.2539,608.1172,1087.2539,612.1172,1077.2539,616.1172,1081.2539,612.1172" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="304.4629" x2="1083.2539" y1="612.1172" y2="612.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170.8345" x="611.4412" y="591.9185">sendPasswordResetEmail(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.0591" x="635.8289" y="607.0513">email, resetToken)</text></g><g class="message" data-participant-1="Email" data-participant-2="Email"><line style="stroke:#181818;stroke-width:1;" x1="1099.2539" x2="1141.2539" y1="641.25" y2="641.25"/><line style="stroke:#181818;stroke-width:1;" x1="1141.2539" x2="1141.2539" y1="641.25" y2="654.25"/><line style="stroke:#181818;stroke-width:1;" x1="1100.2539" x2="1141.2539" y1="654.25" y2="654.25"/><polygon fill="#181818" points="1110.2539,650.25,1100.2539,654.25,1110.2539,658.25,1106.2539,654.25" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.4478" x="1106.2539" y="636.1841">buildResetLink(token)</text></g><g class="message" data-participant-1="Email" data-participant-2="Email"><line style="stroke:#181818;stroke-width:1;" x1="1099.2539" x2="1141.2539" y1="698.5156" y2="698.5156"/><line style="stroke:#181818;stroke-width:1;" x1="1141.2539" x2="1141.2539" y1="698.5156" y2="711.5156"/><line style="stroke:#181818;stroke-width:1;" x1="1100.2539" x2="1141.2539" y1="711.5156" y2="711.5156"/><polygon fill="#181818" points="1110.2539,707.5156,1100.2539,711.5156,1110.2539,715.5156,1106.2539,711.5156" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.7793" x="1106.2539" y="678.3169">composeResetEmail(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.8618" x="1112.7126" y="693.4497">subject, body, link)</text></g><g class="message" data-participant-1="Email" data-participant-2="Email"><line style="stroke:#181818;stroke-width:1;" x1="1099.2539" x2="1141.2539" y1="740.6484" y2="740.6484"/><line style="stroke:#181818;stroke-width:1;" x1="1141.2539" x2="1141.2539" y1="740.6484" y2="753.6484"/><line style="stroke:#181818;stroke-width:1;" x1="1100.2539" x2="1141.2539" y1="753.6484" y2="753.6484"/><polygon fill="#181818" points="1110.2539,749.6484,1100.2539,753.6484,1110.2539,757.6484,1106.2539,753.6484" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76.6543" x="1106.2539" y="735.5825">sendSMTP()</text></g><g class="message" data-participant-1="Email" data-participant-2="AuthCtrl"><polygon fill="#181818" points="315.4629,778.7813,305.4629,782.7813,315.4629,786.7813,311.4629,782.7813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="309.4629" x2="1093.2539" y1="782.7813" y2="782.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.438" x="666.6394" y="777.7153">emailSent</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="247.8765" x2="1270.7017" y1="791.7813" y2="791.7813"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="106.7075" x="252.8765" y="801.9917">[User Not Found]</text><g class="message" data-participant-1="UserModel" data-participant-2="AuthCtrl"><polygon fill="#181818" points="315.4629,833.2852,305.4629,837.2852,315.4629,841.2852,311.4629,837.2852" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="309.4629" x2="545.2744" y1="837.2852" y2="837.2852"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.292" x="379.7227" y="832.2192">userNotFound</text></g><path d="M551,810.5859 L551,850.5859 L737,850.5859 L737,820.5859 L727,810.5859 L551,810.5859" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M727,810.5859 L727,820.5859 L737,820.5859 L727,810.5859" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.6025" x="557" y="827.6528">Don't reveal email</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.5278" x="557" y="842.7856">non-existence for privacy</text><g class="message" data-participant-1="AuthCtrl" data-participant-2="User"><polygon fill="#181818" points="59.9551,910.25,49.9551,914.25,59.9551,918.25,55.9551,914.25" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="53.9551" x2="298.4629" y1="914.25" y2="914.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.6216" x="94.8982" y="878.9185">displayGenericMessage(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.8252" x="102.2964" y="894.0513">"If email is registered,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.9282" x="85.7449" y="909.1841">you will receive reset link")</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1663.7788" x="0" y="942.8164"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1663.7788" y1="942.8164" y2="942.8164"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1663.7788" y1="945.8164" y2="945.8164"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="157.5649" x="753.1069" y="932.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="139.0391" x="759.1069" y="948.3169">Verify Reset Token</text><g class="message" data-participant-1="User" data-participant-2="AuthCtrl"><polygon fill="#181818" points="282.4629,982.5156,292.4629,986.5156,282.4629,990.5156,286.4629,986.5156" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="48.9551" x2="288.4629" y1="986.5156" y2="986.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.5278" x="101.9451" y="981.4497">clickResetLink(token)</text></g><g class="message" data-participant-1="AuthCtrl" data-participant-2="Token"><polygon fill="#181818" points="609.8384,1011.6484,619.8384,1015.6484,609.8384,1019.6484,613.8384,1015.6484" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="304.4629" x2="615.8384" y1="1015.6484" y2="1015.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175.7158" x="375.2927" y="1010.5825">validateResetToken(token)</text></g><g class="message" data-participant-1="Token" data-participant-2="DB"><polygon fill="#181818" points="877.978,1086.1797,887.978,1090.1797,877.978,1094.1797,881.978,1090.1797" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="631.8384" x2="883.978" y1="1090.1797" y2="1090.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.6641" x="710.0762" y="1039.7153">SELECT * FROM</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.7471" x="685.0347" y="1054.8481">password_reset_tokens</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.0957" x="703.3604" y="1069.981">WHERE token = ?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.9902" x="695.4131" y="1085.1138">AND is_used = false</text></g><g class="message" data-participant-1="DB" data-participant-2="Token"><polygon fill="#181818" points="642.8384,1115.3125,632.8384,1119.3125,642.8384,1123.3125,638.8384,1119.3125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="636.8384" x2="893.978" y1="1119.3125" y2="1119.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.5449" x="722.1357" y="1114.2466">tokenRecord</text></g><path d="M10,1134.3125 L74.4429,1134.3125 L74.4429,1141.4453 L64.4429,1151.4453 L10,1151.4453 L10,1134.3125" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="340.2031" style="stroke:#000000;stroke-width:1.5;" width="884.978" x="10" y="1134.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="25" y="1147.3794">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="116.0103" x="89.4429" y="1146.5229">[Token Not Found]</text><g class="message" data-participant-1="Token" data-participant-2="AuthCtrl"><polygon fill="#181818" points="315.4629,1168.5781,305.4629,1172.5781,315.4629,1176.5781,311.4629,1172.5781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="309.4629" x2="620.8384" y1="1172.5781" y2="1172.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.0249" x="423.1382" y="1167.5122">tokenInvalid</text></g><g class="message" data-participant-1="AuthCtrl" data-participant-2="User"><polygon fill="#181818" points="59.9551,1212.8438,49.9551,1216.8438,59.9551,1220.8438,55.9551,1216.8438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="53.9551" x2="293.4629" y1="1216.8438" y2="1216.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.4336" x="129.9922" y="1196.645">displayError(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.3628" x="128.0276" y="1211.7778">"Invalid link")</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="10" x2="894.978" y1="1225.8438" y2="1225.8438"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="90.1592" x="15" y="1236.0542">[Token Found]</text><g class="message" data-participant-1="Token" data-participant-2="Token"><line style="stroke:#181818;stroke-width:1;" x1="631.8384" x2="673.8384" y1="1275.9141" y2="1275.9141"/><line style="stroke:#181818;stroke-width:1;" x1="673.8384" x2="673.8384" y1="1275.9141" y2="1288.9141"/><line style="stroke:#181818;stroke-width:1;" x1="632.8384" x2="673.8384" y1="1288.9141" y2="1288.9141"/><polygon fill="#181818" points="642.8384,1284.9141,632.8384,1288.9141,642.8384,1292.9141,638.8384,1288.9141" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.1162" x="701.3501" y="1255.7153">checkExpiration(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.1396" x="638.8384" y="1270.8481">tokenRecord.expiration_timestamp)</text></g><path d="M20,1303.9141 L84.4429,1303.9141 L84.4429,1311.0469 L74.4429,1321.0469 L20,1321.0469 L20,1303.9141" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="163.6016" style="stroke:#000000;stroke-width:1.5;" width="659.3853" x="20" y="1303.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="35" y="1316.981">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="98.5649" x="99.4429" y="1316.1245">[Token Expired]</text><g class="message" data-participant-1="Token" data-participant-2="AuthCtrl"><polygon fill="#181818" points="315.4629,1338.1797,305.4629,1342.1797,315.4629,1346.1797,311.4629,1342.1797" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="309.4629" x2="620.8384" y1="1342.1797" y2="1342.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.1821" x="420.0596" y="1337.1138">tokenExpired</text></g><g class="message" data-participant-1="AuthCtrl" data-participant-2="User"><polygon fill="#181818" points="59.9551,1382.4453,49.9551,1386.4453,59.9551,1390.4453,55.9551,1386.4453" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="53.9551" x2="293.4629" y1="1386.4453" y2="1386.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.4336" x="129.9922" y="1366.2466">displayError(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.084" x="103.167" y="1381.3794">"Token has expired")</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="20" x2="679.3853" y1="1395.4453" y2="1395.4453"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="82.9028" x="25" y="1405.6558">[Token Valid]</text><g class="message" data-participant-1="Token" data-participant-2="AuthCtrl"><polygon fill="#181818" points="315.4629,1426.3828,305.4629,1430.3828,315.4629,1434.3828,311.4629,1430.3828" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="309.4629" x2="625.8384" y1="1430.3828" y2="1430.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.8569" x="406.7222" y="1425.3169">tokenValid, userId</text></g><g class="message" data-participant-1="AuthCtrl" data-participant-2="User"><polygon fill="#181818" points="59.9551,1455.5156,49.9551,1459.5156,59.9551,1463.5156,55.9551,1459.5156" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="53.9551" x2="293.4629" y1="1459.5156" y2="1459.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.6323" x="81.8928" y="1454.4497">displayNewPasswordForm()</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1663.7788" x="0" y="1502.082"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1663.7788" y1="1502.082" y2="1502.082"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1663.7788" y1="1505.082" y2="1505.082"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="181.8574" x="740.9607" y="1491.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="163.3315" x="746.9607" y="1507.5825">Submit New Password</text><g class="message" data-participant-1="User" data-participant-2="AuthCtrl"><polygon fill="#181818" points="282.4629,1572.0469,292.4629,1576.0469,282.4629,1580.0469,286.4629,1576.0469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="48.9551" x2="288.4629" y1="1576.0469" y2="1576.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.5977" x="101.9102" y="1540.7153">submitNewPassword(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.6172" x="102.9004" y="1555.8481">token, newPassword,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.1431" x="113.6375" y="1570.981">confirmPassword)</text></g><g class="message" data-participant-1="AuthCtrl" data-participant-2="AuthCtrl"><line style="stroke:#181818;stroke-width:1;" x1="304.4629" x2="346.4629" y1="1620.3125" y2="1620.3125"/><line style="stroke:#181818;stroke-width:1;" x1="346.4629" x2="346.4629" y1="1620.3125" y2="1633.3125"/><line style="stroke:#181818;stroke-width:1;" x1="305.4629" x2="346.4629" y1="1633.3125" y2="1633.3125"/><polygon fill="#181818" points="315.4629,1629.3125,305.4629,1633.3125,315.4629,1637.3125,311.4629,1633.3125" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.0503" x="311.4629" y="1600.1138">validatePasswordRequirements(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.4756" x="369.7502" y="1615.2466">newPassword)</text></g><path d="M10,1648.3125 L74.4429,1648.3125 L74.4429,1655.4453 L64.4429,1665.4453 L10,1665.4453 L10,1648.3125" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1190.5859" style="stroke:#000000;stroke-width:1.5;" width="1643.7788" x="10" y="1648.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="25" y="1661.3794">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="115.4141" x="89.4429" y="1660.5229">[Password Invalid]</text><g class="message" data-participant-1="AuthCtrl" data-participant-2="User"><polygon fill="#181818" points="59.9551,1712.8438,49.9551,1716.8438,59.9551,1720.8438,55.9551,1716.8438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="53.9551" x2="293.4629" y1="1716.8438" y2="1716.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.0137" x="69.7021" y="1681.5122">displayPasswordRequirements(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.4209" x="90.9985" y="1696.645">"Min 8 chars, uppercase,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189.103" x="77.1575" y="1711.7778">lowercase, number, special")</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="10" x2="1653.7788" y1="1725.8438" y2="1725.8438"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="104.833" x="15" y="1736.0542">[Password Valid]</text><g class="message" data-participant-1="AuthCtrl" data-participant-2="AuthCtrl"><line style="stroke:#181818;stroke-width:1;" x1="304.4629" x2="346.4629" y1="1775.9141" y2="1775.9141"/><line style="stroke:#181818;stroke-width:1;" x1="346.4629" x2="346.4629" y1="1775.9141" y2="1788.9141"/><line style="stroke:#181818;stroke-width:1;" x1="305.4629" x2="346.4629" y1="1788.9141" y2="1788.9141"/><polygon fill="#181818" points="315.4629,1784.9141,305.4629,1788.9141,315.4629,1792.9141,311.4629,1788.9141" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.106" x="342.3157" y="1755.7153">checkPasswordsMatch(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212.8115" x="311.4629" y="1770.8481">newPassword, confirmPassword)</text></g><path d="M20,1803.9141 L84.4429,1803.9141 L84.4429,1811.0469 L74.4429,1821.0469 L20,1821.0469 L20,1803.9141" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1027.9844" style="stroke:#000000;stroke-width:1.5;" width="1623.7788" x="20" y="1803.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="35" y="1816.981">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="154.9829" x="99.4429" y="1816.1245">[Passwords Don't Match]</text><g class="message" data-participant-1="AuthCtrl" data-participant-2="User"><polygon fill="#181818" points="59.9551,1853.3125,49.9551,1857.3125,59.9551,1861.3125,55.9551,1857.3125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="53.9551" x2="293.4629" y1="1857.3125" y2="1857.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.4336" x="129.9922" y="1837.1138">displayError(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.3442" x="83.5369" y="1852.2466">"Passwords do not match")</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="20" x2="1643.7788" y1="1866.3125" y2="1866.3125"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="118.0083" x="25" y="1876.5229">[Passwords Match]</text><g class="message" data-participant-1="AuthCtrl" data-participant-2="Sec"><polygon fill="#181818" points="1300.541,1897.25,1310.541,1901.25,1300.541,1905.25,1304.541,1901.25" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="304.4629" x2="1306.541" y1="1901.25" y2="1901.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191.2993" x="712.8523" y="1896.1841">hashPassword(newPassword)</text></g><g class="message" data-participant-1="Sec" data-participant-2="Sec"><line style="stroke:#181818;stroke-width:1;" x1="1322.541" x2="1364.541" y1="1930.3828" y2="1930.3828"/><line style="stroke:#181818;stroke-width:1;" x1="1364.541" x2="1364.541" y1="1930.3828" y2="1943.3828"/><line style="stroke:#181818;stroke-width:1;" x1="1323.541" x2="1364.541" y1="1943.3828" y2="1943.3828"/><polygon fill="#181818" points="1333.541,1939.3828,1323.541,1943.3828,1333.541,1947.3828,1329.541,1943.3828" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.0469" x="1329.541" y="1925.3169">bcrypt(newPassword, salt)</text></g><g class="message" data-participant-1="Sec" data-participant-2="AuthCtrl"><polygon fill="#181818" points="315.4629,1968.5156,305.4629,1972.5156,315.4629,1976.5156,311.4629,1972.5156" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="309.4629" x2="1316.541" y1="1972.5156" y2="1972.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94.7007" x="763.6516" y="1967.4497">passwordHash</text></g><g class="message" data-participant-1="AuthCtrl" data-participant-2="UserModel"><polygon fill="#181818" points="529.2744,2012.7813,539.2744,2016.7813,529.2744,2020.7813,533.2744,2016.7813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="304.4629" x2="535.2744" y1="2016.7813" y2="2016.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.4106" x="366.6633" y="1996.5825">updatePassword(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.478" x="348.6296" y="2011.7153">userId, passwordHash)</text></g><g class="message" data-participant-1="UserModel" data-participant-2="DB"><polygon fill="#181818" points="877.978,2072.1797,887.978,2076.1797,877.978,2080.1797,881.978,2076.1797" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="551.2744" x2="883.978" y1="2076.1797" y2="2076.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.6729" x="674.7898" y="2040.8481">UPDATE users</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.2607" x="643.4958" y="2055.981">SET password_hash = ?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90.1431" x="675.5547" y="2071.1138">WHERE id = ?</text></g><g class="message" data-participant-1="DB" data-participant-2="UserModel"><polygon fill="#181818" points="562.2744,2101.3125,552.2744,2105.3125,562.2744,2109.3125,558.2744,2105.3125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="556.2744" x2="893.978" y1="2105.3125" y2="2105.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.8511" x="697.7007" y="2100.2466">success</text></g><g class="message" data-participant-1="UserModel" data-participant-2="AuthCtrl"><polygon fill="#181818" points="315.4629,2130.4453,305.4629,2134.4453,315.4629,2138.4453,311.4629,2134.4453" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="309.4629" x2="545.2744" y1="2134.4453" y2="2134.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.2793" x="366.729" y="2129.3794">passwordUpdated</text></g><g class="message" data-participant-1="AuthCtrl" data-participant-2="Token"><polygon fill="#181818" points="609.8384,2159.5781,619.8384,2163.5781,609.8384,2167.5781,613.8384,2163.5781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="304.4629" x2="615.8384" y1="2163.5781" y2="2163.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.5669" x="369.3672" y="2158.5122">invalidateResetToken(token)</text></g><g class="message" data-participant-1="Token" data-participant-2="DB"><polygon fill="#181818" points="877.978,2234.1094,887.978,2238.1094,877.978,2242.1094,881.978,2238.1094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="631.8384" x2="883.978" y1="2238.1094" y2="2238.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52.4126" x="734.7019" y="2187.645">UPDATE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.7471" x="685.0347" y="2202.7778">password_reset_tokens</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.5225" x="699.647" y="2217.9106">SET is_used = true</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.0957" x="703.3604" y="2233.0435">WHERE token = ?</text></g><g class="message" data-participant-1="AuthCtrl" data-participant-2="Session"><polygon fill="#181818" points="1506.5879,2308.375,1516.5879,2312.375,1506.5879,2316.375,1510.5879,2312.375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="304.4629" x2="1512.5879" y1="2312.375" y2="2312.375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.2407" x="825.905" y="2292.1763">invalidateAllUserSessions(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="45.5127" x="888.769" y="2307.3091">userId)</text></g><g class="message" data-participant-1="Session" data-participant-2="DB"><polygon fill="#181818" points="910.978,2352.6406,900.978,2356.6406,910.978,2360.6406,906.978,2356.6406" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="904.978" x2="1517.5879" y1="2356.6406" y2="2356.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150.9536" x="1133.8062" y="2336.4419">DELETE FROM sessions</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.998" x="1146.7839" y="2351.5747">WHERE user_id = ?</text></g><g class="message" data-participant-1="DB" data-participant-2="Session"><polygon fill="#181818" points="1511.5879,2381.7734,1521.5879,2385.7734,1511.5879,2389.7734,1515.5879,2385.7734" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="894.978" x2="1517.5879" y1="2385.7734" y2="2385.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.8511" x="1183.8574" y="2380.7075">success</text></g><g class="message" data-participant-1="AuthCtrl" data-participant-2="Logger"><polygon fill="#181818" points="1585.5249,2426.0391,1595.5249,2430.0391,1585.5249,2434.0391,1589.5249,2430.0391" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="304.4629" x2="1591.5249" y1="2430.0391" y2="2430.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.5146" x="893.2366" y="2409.8403">logSecurityEvent(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.5825" x="869.7026" y="2424.9731">userId, 'password_reset')</text></g><g class="message" data-participant-1="Logger" data-participant-2="DB"><polygon fill="#181818" points="910.978,2485.4375,900.978,2489.4375,910.978,2493.4375,906.978,2489.4375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="904.978" x2="1596.5249" y1="2489.4375" y2="2489.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.2515" x="1172.1257" y="2454.106">INSERT INTO audit_logs</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.1426" x="1196.1802" y="2469.2388">(user_id, action)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189.2554" x="1154.1238" y="2484.3716">VALUES (?, 'password_reset')</text></g><g class="message" data-participant-1="AuthCtrl" data-participant-2="Email"><polygon fill="#181818" points="1077.2539,2559.7031,1087.2539,2563.7031,1077.2539,2567.7031,1081.2539,2563.7031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="304.4629" x2="1083.2539" y1="2563.7031" y2="2563.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.7363" x="618.4902" y="2543.5044">sendConfirmationEmail(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="45.5127" x="674.1021" y="2558.6372">userId)</text></g><g class="message" data-participant-1="Email" data-participant-2="DB"><polygon fill="#181818" points="910.978,2603.9688,900.978,2607.9688,910.978,2611.9688,906.978,2607.9688" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="904.978" x2="1088.2539" y1="2607.9688" y2="2607.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170.2759" x="909.478" y="2587.77">SELECT email FROM users</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90.1431" x="949.5444" y="2602.9028">WHERE id = ?</text></g><g class="message" data-participant-1="DB" data-participant-2="Email"><polygon fill="#181818" points="1077.2539,2633.1016,1087.2539,2637.1016,1077.2539,2641.1016,1081.2539,2637.1016" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="894.978" x2="1083.2539" y1="2637.1016" y2="2637.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.4224" x="959.9048" y="2632.0356">userEmail</text></g><g class="message" data-participant-1="Email" data-participant-2="Email"><line style="stroke:#181818;stroke-width:1;" x1="1099.2539" x2="1141.2539" y1="2666.2344" y2="2666.2344"/><line style="stroke:#181818;stroke-width:1;" x1="1141.2539" x2="1141.2539" y1="2666.2344" y2="2679.2344"/><line style="stroke:#181818;stroke-width:1;" x1="1100.2539" x2="1141.2539" y1="2679.2344" y2="2679.2344"/><polygon fill="#181818" points="1110.2539,2675.2344,1100.2539,2679.2344,1110.2539,2683.2344,1106.2539,2679.2344" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189.2871" x="1106.2539" y="2661.1685">composeConfirmationEmail()</text></g><g class="message" data-participant-1="Email" data-participant-2="Email"><line style="stroke:#181818;stroke-width:1;" x1="1099.2539" x2="1141.2539" y1="2708.3672" y2="2708.3672"/><line style="stroke:#181818;stroke-width:1;" x1="1141.2539" x2="1141.2539" y1="2708.3672" y2="2721.3672"/><line style="stroke:#181818;stroke-width:1;" x1="1100.2539" x2="1141.2539" y1="2721.3672" y2="2721.3672"/><polygon fill="#181818" points="1110.2539,2717.3672,1100.2539,2721.3672,1110.2539,2725.3672,1106.2539,2721.3672" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76.6543" x="1106.2539" y="2703.3013">sendSMTP()</text></g><g class="message" data-participant-1="Email" data-participant-2="AuthCtrl"><polygon fill="#181818" points="315.4629,2746.5,305.4629,2750.5,315.4629,2754.5,311.4629,2750.5" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="309.4629" x2="1093.2539" y1="2750.5" y2="2750.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.438" x="666.6394" y="2745.4341">emailSent</text></g><g class="message" data-participant-1="AuthCtrl" data-participant-2="User"><polygon fill="#181818" points="59.9551,2790.7656,49.9551,2794.7656,59.9551,2798.7656,55.9551,2794.7656" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="53.9551" x2="293.4629" y1="2794.7656" y2="2794.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.562" x="119.928" y="2774.5669">displaySuccess(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221.5078" x="60.9551" y="2789.6997">"Password changed successfully")</text></g><g class="message" data-participant-1="AuthCtrl" data-participant-2="User"><polygon fill="#181818" points="59.9551,2819.8984,49.9551,2823.8984,59.9551,2827.8984,55.9551,2823.8984" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="53.9551" x2="293.4629" y1="2823.8984" y2="2823.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.1313" x="115.6433" y="2818.8325">redirectToLogin()</text></g><!--SRC=[bLTRJ-iu47xFhx3wGikMbNRtPLM9WmeD2n85r1REIwNAJTpYnRLpR0TE__qPsxdOQL9w48B46S_bcs_6O_LEUOObtY55VkI49sHAbC9RCcPqor52k2OoKfMK92eJN9LIruI9px6KuXDfcPCeqbGpWixFdx5IdqAcQ4OKqUXPYWHsd9z74KwqaAZteeZi8QoGUOX0kQO9pJ3Ng3VEzTkItmYkfM2i43EBDrgoKDHiNlAfI0chbDctK6mXtWbVyly89nA3UIjh5qEv2TPuZHMntoVNuSTuXobRyZcH7pHn8dOfb9gJ99TKx-rtU6b-LOeAS6MAES0d2ocxs0GXfNh97yIs57EFKNHv2Q12hXJ06g9yUHb51W5qyQt2QmGfiyAbh1Nj4-Fvm2I3Vc1DQdYZyiaegU0SeGtbgNcztjkW3nJKo5TFHiFaUeJcyKDyiq3dw7RsD4KvV5PB_lqkdiN8Qa6NwAfM1B1Fhj55QDricf44t8zIuej6c6ahYEAVL6aL8VZnF0YGC5hkKolYQQazDn_i7ny3IvCHsZhk40kVNUixTGExezBcM6MMx5EB1iiGubJyy_SWb3LutJ_Euza2_YsUbb1sBcqhQGolj144-Apn5Ks7oAuCbvpyp2Ye1oAjDDr1ml4k6opvw_ZX9PwZ_jKGmU_Zq_V-0Fs1_a9tJo-pXki0ftalq2-yLdbYAhS9MY5R-DtWMubGSrEzU82o9HLO8pmDYEh81j6P_qDFTyDtLubcoJvvAjSvPKxN0-NlVLrlRaecOfS9HGAxAb__Jn8zH6kHxeU8WOhspSRp-NJnt0y-1y3O6ERGKPkuEES9KuwCw55eT2joddx9Pf2i1JivpGKiIRfzqoCq4VnC0uuV13FdqP9pmI-8AH_J_z46sdCcGK-oZo0eloCKHJb2ALKPmtlRK6bI70O0L-z-KzGqLM1aQtHAaW8zzo97dvGnM4q8_I0kbHRGtY3ogxfkHT3fNa7_Pb_qDyUszYwNC9gy7wJvY_vMSFm3Cvg6jTtSxwWRb6dGrZeBrVKvxJn7Lqi-Vfm0E2l8NWeB6mnPRsj-XMjsOtVdSmw5V6chIQlcdjj06xNNp6aCfxcqgNJYPOeiFPtk0rkLkyaRITxZgXE16Y-0FrjRLDqFwe2i1k9C70sfANX2M4xN6noen6tkEHUy-5uhc8uQjs93_rJfx7V7VNiadsNJknLoLxGGKtks_hfgOvwlTrGZs5qF0kt5eQoaPwPCp13nUX6gD15yG-MkNFcoW6eJPGtLtVj73kZkeDqfiEQP6JZgLYwVHiiElRqfvUXVu1sM2bAHPKGcCC11A32O5i-8vxiraKEaCf9Gp4eoLnwyjjWFUejXTIcjfbWdRs58GtG0NC3gQc_HVgsAto5jhI0LffsZdT7WCxUMw5B-pOoZ8yFyjue6GLhABLNEpVXQBi9pfMATo7sc-m402k8SXD81XcLxl0FpRRNYssfrtfy6CvzfW8yhmM5Wf2MUy5HidAskgRyyJyQBk1nIv_6YqhaomBaMxdewJUtWUc2b68syKSfptH-dsaUgOqT-wSkB1Q2rvnp6s8fcqQyfxpxx3W8Bsrbm5ZhOEWz1WsDzvfcRui71U1J7TfGwEsq7-Uqjouzvp9Y1g_YYAYArbeAxezK4j-zb_1EO1O0szeAZ2dLbYCMaVYfPAZzFeqfGGg6FhJ2uM-G8CR4jhwhn1pHJhuhEmYoUjS1Ht4NBTVVQSdz1s5nZLs0ikBCOFOA7jvCJhFuE8neUjcBXZUuthd_RuQIS_Jl9K5ysWfk0DnIw6VZmldiw3GhVpExGN7la7NUPmx06dLiQDvZJRZ6jDvaZe3TFkBaZkN_6cSESRw5J50MmoHdRzmR7bC4K1pD10lqBqaxv2GFKBm00]--></g></svg>